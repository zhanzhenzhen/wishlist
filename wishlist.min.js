/* @preserve
Wishlist
https://github.com/zhanzhenzhen/wishlist
(c) 2014 Zhenzhen Zhan
Wishlist may be freely distributed under the MIT license.
 */
(function(){var npmWishlist,__indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};npmWishlist={};npmWishlist.environmentType=typeof exports!=="undefined"&&exports!==null&&(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null?"node":typeof window!=="undefined"&&window!==null?"browser":void 0;npmWishlist.Test=function(){function Test(e){this.description=e!=null?e:"";this._children=[];this._fun=function(e){return function(){}}(this);this._wishlist=[];this.async=false;this.parent=null;this._resetContext()}Test.prototype._resetContext=function(){this.env={};this.wishResults=[];return this.result=null};Test.prototype.set=function(e){this._fun=e;return this};Test.prototype.get=function(){return this._fun};Test.prototype.setWishlist=function(e){this._wishlist=e;return this};Test.prototype.getWishlist=function(){return this._wishlist};Test.prototype.add=function(){var e,t,n,s,r,i;n=null;if(arguments[0]instanceof npmWishlist.Test){n=arguments[0]}else{e=t=i=r=null;s=function(e){return function(e){var t;t=Array.isArray(e)?e.join(";"):typeof e==="string"?e:"";return npmWishlist.parseWishlist(t)}}(this);if(typeof arguments[0]==="string"){e=arguments[0];t=arguments[1];if(typeof arguments[2]==="object"&&arguments[2]!==null&&!Array.isArray(arguments[2])){r=arguments[2]}else{i=s(arguments[2]);r=arguments[3]}}else{t=arguments[0];if(typeof arguments[1]==="object"&&arguments[1]!==null&&!Array.isArray(arguments[1])){r=arguments[1]}else{i=s(arguments[1]);r=arguments[2]}}if(e==null){e=""}if(i==null){i=[]}if(r==null){r={}}n=new npmWishlist.Test(e).set(t).setWishlist(i);if(r.async){n.async=true}}n.parent=this;this._children.push(n);return this};Test.prototype.addAsync=function(){var e,t,n,s;e=[];for(n=0,s=arguments.length;n<s;n++){t=arguments[n];e.push(t)}e.push({async:true});return this.add.apply(this,e)};Test.prototype.getChildren=function(){return this._children.slice(0)};Test.prototype.getAncestors=function(){var e,t;t=this;e=[];while(t.parent!==null){e.push(t.parent);t=t.parent}return e};Test.prototype.run=function(e){var t,n,s,r;if(e==null){e=true}this._resetContext();if(this.parent!=null){this.env=npmWishlist.objectClone(this.parent.env)}setTimeout(function(e){return function(){var t;if(typeof exports!=="undefined"&&exports!==null&&(typeof module!=="undefined"&&module!==null?module.exports:void 0)!=null){t=require("domain").create();t.on("error",function(t){return e.end({type:false,errorMessage:"Error Name: "+t.name+"\nError Message: "+t.message+"\nError Stack: "+t.stack})});t.run(function(){return e._fun(e.env,e)})}else{try{e._fun(e.env,e)}catch(t){e.end({type:false})}}if(e.result==null&&!e.async){return e.end({type:true})}}}(this),0);if(e){t=[];t.push(this);r=function(e){return function(e){return e.getChildren().forEach(function(e){t.push(e);return r(e)})}}(this);r(this);console.log();s=function(e){return function(){var e,s,r,i,l,u,o;l=t.filter(function(e){return e.result!=null&&e.result.type===true});e=t.filter(function(e){return e.result!=null&&e.result.type===false});u=t.filter(function(e){return e.result==null});console.log(""+(new Date).toISOString()+" OK: "+l.length+", "+("Exception: "+e.length+", Pending: "+u.length));if(u.length===0){clearInterval(n);e.forEach(function(e){console.log("\n********** Exceptional Test **********");console.log("Test: "+e.description);console.log("Function: "+e.get().toString());if(e.result.errorMessage!=null){return console.log(e.result.errorMessage)}});s=0;o=0;i="";t.forEach(function(e){return e.wishResults.forEach(function(t){var n,r;i+=" "+t.type.toString();if(t.type===false){s++;n=e.getAncestors();n.reverse();r=n.concat([e]).map(function(e){return e.description}).join(" --> ");console.log("\n********** Broken Wish **********");console.log("    Test: "+r);console.log("    Wish: "+t.description);console.log("Expected: "+t.expected);return console.log("  Actual: "+t.actual)}else{return o++}})});i=i.trim();r=npmWishlist.sha256(i).substr(0,5);console.log("\n"+((e.length===0?"Tests OK.":""+e.length+" tests of "+t.length+" exceptional.")+" "+(s===0?"Wishes fulfilled.":""+s+" wishes of "+(s+o)+" broken.")+" "+("Mark: "+r))+"\n");if(typeof process!=="undefined"&&process!==null){return process.exit()}}}}(this);n=setInterval(s,1e3);setTimeout(s,10)}return this};Test.prototype.end=function(e){if(this.result==null){this.result=e!=null?e:{type:true};this.getWishlist().forEach(function(e){return function(t){return e._checkWish(t)}}(this));this.getChildren().forEach(function(e){return function(e){return e.run(false)}}(this))}return this};Test.prototype._checkWish=function(wishStr){var args,interpret,newResult,parsed,that;that=this;interpret=function(e){return function(t){npmWishlist.parseExpression(t,Object.keys(e.env)).forEach(function(e,n){var s,r;s="that.env.";r=e+s.length*n;return t=t.substr(0,r)+s+t.substr(r)});return t}}(this);parsed=npmWishlist.parseWish(wishStr);args=parsed.components.map(function(e){return function(e,t){if(t===parsed.components.length-1){return e}else{return interpret(e)}}}(this));try{return eval("that."+parsed.type+"("+args.join(", ")+")")}catch(e){newResult={type:false,description:JSON.parse(args[args.length-1]),actual:"unknown",expected:"unknown"};return this.wishResults.push(newResult)}};Test.prototype.wish=function(e){return npmWishlist.parseWishlist(e).forEach(function(e){return function(t){return e._checkWish(t)}}(this))};Test.prototype.equal=function(e,t,n){var s,r,i;if(n==null){n=""}i=[];s=function(e){return function(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(t.every(function(t,n){if(__indexOf.call(i,t)>=0){return npmWishlist.objectIs(e[n],t)}else{if(typeof t==="object"&&t!==null){i.push(t)}return s(e[n],t)}})){return true}else{return false}}else if(typeof e==="object"&&e!==null&&typeof t==="object"&&t!==null){if(Object.keys(t).every(function(n){var r;if(r=t[n],__indexOf.call(i,r)>=0){return npmWishlist.objectIs(e[n],t[n])}else{if(typeof t[n]==="object"&&t[n]!==null){i.push(t[n])}return s(e[n],t[n])}})){return true}else{return false}}else{return npmWishlist.objectIs(e,t)}}}(this);r={type:s(e,t),description:n};if(r.type===false){r.actual=npmWishlist.valueToMessage(e);r.expected="= "+npmWishlist.valueToMessage(t)}this.wishResults.push(r);return this};Test.prototype.notEqual=function(e,t,n){var s,r,i;if(n==null){n=""}i=[];s=function(e){return function(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(t.some(function(t,n){if(__indexOf.call(i,t)>=0){return!npmWishlist.objectIs(e[n],t)}else{if(typeof t==="object"&&t!==null){i.push(t)}return s(e[n],t)}})){return true}else{return false}}else if(typeof e==="object"&&e!==null&&typeof t==="object"&&t!==null){if(Object.keys(t).some(function(n){var r;if(r=t[n],__indexOf.call(i,r)>=0){return!npmWishlist.objectIs(e[n],t[n])}else{if(typeof t[n]==="object"&&t[n]!==null){i.push(t[n])}return s(e[n],t[n])}})){return true}else{return false}}else{return!npmWishlist.objectIs(e,t)}}}(this);r={type:s(e,t),description:n};if(r.type===false){r.actual=npmWishlist.valueToMessage(e);r.expected="â‰  "+npmWishlist.valueToMessage(t)}this.wishResults.push(r);return this};Test.prototype.is=function(e,t,n){var s;if(n==null){n=""}s={type:npmWishlist.objectIs(e,t),description:n};if(s.type===false){s.actual=npmWishlist.valueToMessage(e);s.expected="is "+npmWishlist.valueToMessage(t)}this.wishResults.push(s);return this};Test.prototype.isnt=function(e,t,n){var s;if(n==null){n=""}s={type:!npmWishlist.objectIs(e,t),description:n};if(s.type===false){s.actual=npmWishlist.valueToMessage(e);s.expected="isn't "+npmWishlist.valueToMessage(t)}this.wishResults.push(s);return this};Test.prototype.throws=function(e,t,n){var s,r,i,l;if(n==null){n=""}i=false;l=function(){try{e();i=true;return false}catch(e){s=e;if(t==null){return true}else if(t instanceof RegExp){if(t.test(s.message)){return true}else{return false}}else{if(s instanceof t){return true}else{return false}}}}();r={type:l,description:n};if(r.type===false){r.actual=i?"no exception":"another exception";r.expected=i?"exception":"an exception"}this.wishResults.push(r);return this};Test.prototype.doesNotThrow=function(e,t){var n,s;if(t==null){t=""}s=function(){try{e();return true}catch(e){return false}}();n={type:s,description:t};if(n.type===false){n.actual="exception";n.expected="no exception"}this.wishResults.push(n);return this};Test.prototype.lessThan=function(e,t,n){var s;if(n==null){n=""}s={type:e<t,description:n};if(s.type===false){s.actual=npmWishlist.valueToMessage(e);s.expected="< "+npmWishlist.valueToMessage(t)}this.wishResults.push(s);return this};Test.prototype.lessThanOrEqual=function(e,t,n){var s;if(n==null){n=""}s={type:e<=t,description:n};if(s.type===false){s.actual=npmWishlist.valueToMessage(e);s.expected="<= "+npmWishlist.valueToMessage(t)}this.wishResults.push(s);return this};Test.prototype.greaterThan=function(e,t,n){var s;if(n==null){n=""}s={type:e>t,description:n};if(s.type===false){s.actual=npmWishlist.valueToMessage(e);s.expected="> "+npmWishlist.valueToMessage(t)}this.wishResults.push(s);return this};Test.prototype.greaterThanOrEqual=function(e,t,n){var s;if(n==null){n=""}s={type:e>=t,description:n};if(s.type===false){s.actual=npmWishlist.valueToMessage(e);s.expected=">= "+npmWishlist.valueToMessage(t)}this.wishResults.push(s);return this};return Test}();npmWishlist.objectIs=function(e,t){if(typeof e==="number"&&typeof t==="number"){if(e===0&&t===0){return 1/e===1/t}else if(isNaN(e)&&isNaN(t)){return true}else{return e===t}}else{return e===t}};npmWishlist.objectClone=function(e){var t,n,s,r,i;n={};i=Object.keys(e);for(s=0,r=i.length;s<r;s++){t=i[s];n[t]=e[t]}return n};npmWishlist.valueToMessage=function(e){var t,n;t=function(e,n){if(e===void 0){return"undefined"}else if(e===null){return"null"}else if(Array.isArray(e)){if(n>0){return"["+e.map(function(e){return t(e,n-1)}).join(",")+"]"}else{return"[Array]"}}else if(typeof e==="function"){return"[Function]"}else if(typeof e==="object"){if(n>0){return"{"+Object.keys(e).map(function(s){return""+JSON.stringify(s)+":"+t(e[s],n-1)}).join(",")+"}"}else{return"[Object]"}}else if(typeof e==="string"){return JSON.stringify(e.toString())}else if(typeof e==="number"){if(npmWishlist.objectIs(e,-0)){return"-0"}else{return e.toString()}}else{return e.toString()}};n=t(e,3);if(n.length>1e3){n=t(e,2)}if(n.length>1e3){n=t(e,1)}if(n.length>1e3){n=t(e,0)}return n};npmWishlist.parseExpression=function(e,t){var n,s,r,i,l,u,o,f,a,h,p,c,m,y;e+=" ";if(t.length===0){return[]}p=new RegExp("^("+t.join("|")+")[^a-zA-Z0-9_$]","g");a=[];h=null;m=true;y=false;s=false;i=false;r=0;while(r<e.length-1){n=e[r];o=m;if(h===null){if("a"<=n&&n<="z"||"A"<=n&&n<="Z"||"0"<=n&&n<="9"||n==="_"||n==="$"||n===")"||n==="]"){m=false}else if(n===" "||n==="	"||n==="\n"||n==="\r"){}else{m=true}}f=y;if(h===null){if("a"<=n&&n<="z"||"A"<=n&&n<="Z"||"0"<=n&&n<="9"||n==="_"||n==="$"||n==="."){y=true}else{y=false}}l=s;if(h===null){if(n==="."){s=true}else if(n===" "||n==="	"||n==="\n"||n==="\r"){}else{s=false}}u=i;if(h===null){if(n==="{"||n===","){i=true}else if(n===" "||n==="	"||n==="\n"||n==="\r"){}else{i=false}}if(n==='"'&&h===null){h="double";r++}else if(n==="'"&&h===null){h="single";r++}else if(n==="/"&&h===null&&o){h="slash";r++}else if(n==='"'&&h==="double"||n==="'"&&h==="single"||n==="/"&&h==="slash"){h=null;r++}else if(n==="\\"&&h!==null){r+=2}else if(h===null&&!f&&!l&&("a"<=n&&n<="z"||"A"<=n&&n<="Z")){c=e.substr(r,31);if(!(u&&c.search(/^([a-zA-Z0-9_$])+\s*:/)!==-1)&&c.search(p)!==-1){a.push(r)}r++}else{r++}}return a};npmWishlist.parseWish=function(e){var t,n;n=null;t=null;[0,1].forEach(function(s){var r,i,l,u,o,f,a,h,p,c,m,y;c=null;p=0;i=0;r=0;y=true;u=false;o=0;while(o<e.length){l=e[o];h=y;if(c===null){if("a"<=l&&l<="z"||"A"<=l&&l<="Z"||"0"<=l&&l<="9"||l==="_"||l==="$"||l===")"||l==="]"){y=false}else if(l===" "||l==="	"||l==="\n"||l==="\r"){}else{y=true}}a=u;if(c===null){if(l==="."){u=true}else if(l===" "||l==="	"||l==="\n"||l==="\r"){}else{u=false}}if(l==='"'&&c===null){c="double";o++}else if(l==="'"&&c===null){c="single";o++}else if(l==="/"&&c===null&&h){c="slash";o++}else if(l==='"'&&c==="double"||l==="'"&&c==="single"||l==="/"&&c==="slash"){c=null;o++}else if(l==="\\"&&c!==null){o+=2}else if(l==="("){p++;o++}else if(l==="["){i++;o++}else if(l==="{"){r++;o++}else if(l===")"){p--;o++}else if(l==="]"){i--;o++}else if(l==="}"){r--;o++}else if(c===null&&!a&&(p===i&&i===r&&r===0)){if(s===0){if(l===":"){t=e.substr(o+1);e=e.substr(0,o);break}}else if(s===1){m=e.substr(o);if((f=m.match(/^=([^]+)$/))!=null){n={type:"equal",components:[e.substr(0,o),f[1]]};break}else if((f=m.match(/^<>([^]+)$/))!=null){n={type:"notEqual",components:[e.substr(0,o),f[1]]};break}else if((f=m.match(/^\sis\s([^]+)$/))!=null){n={type:"is",components:[e.substr(0,o),f[1]]};break}else if((f=m.match(/^\sisnt\s([^]+)$/))!=null){n={type:"isnt",components:[e.substr(0,o),f[1]]};break}else if((f=m.match(/^\sthrows(?:\s([^]+))?$/))!=null){n={type:"throws",components:[e.substr(0,o),f[1]!=null?f[1]:"undefined"]};break}else if((f=m.match(/^<=([^]+)$/))!=null){n={type:"lessThanOrEqual",components:[e.substr(0,o),f[1]]};break}else if((f=m.match(/^>=([^]+)$/))!=null){n={type:"greaterThanOrEqual",components:[e.substr(0,o),f[1]]};break}else if((f=m.match(/^<([^]+)$/))!=null){n={type:"lessThan",components:[e.substr(0,o),f[1]]};break}else if((f=m.match(/^>([^]+)$/))!=null){n={type:"greaterThan",components:[e.substr(0,o),f[1]]};break}}o++}else{o++}}if(s===1){return n!=null?n:n={type:"doesNotThrow",components:[e]}}});n.components.push(JSON.stringify(t!=null?t:e));n.components=n.components.map(function(e){return e.trim()});return n};npmWishlist.parseWishlist=function(e){var t,n,s,r,i,l,u,o,f,a,h,p;f=null;u=0;n=0;t=0;p=true;o=[];r=0;while(r<e.length){s=e[r];l=p;if(f===null){if("a"<=s&&s<="z"||"A"<=s&&s<="Z"||"0"<=s&&s<="9"||s==="_"||s==="$"||s===")"||s==="]"){p=false}else if(s===" "||s==="	"||s==="\n"||s==="\r"){}else{p=true}}if(s==='"'&&f===null){f="double";r++}else if(s==="'"&&f===null){f="single";r++}else if(s==="/"&&f===null&&l){f="slash";r++}else if(s==='"'&&f==="double"||s==="'"&&f==="single"||s==="/"&&f==="slash"){f=null;r++}else if(s==="\\"&&f!==null){r+=2}else if(s==="("){u++;r++}else if(s==="["){n++;r++}else if(s==="{"){t++;r++}else if(s===")"){u--;r++}else if(s==="]"){n--;r++}else if(s==="}"){t--;r++}else if(f===null&&(u===n&&n===t&&t===0)&&s===";"){o.push(r);r++}else{r++}}a=[];i=-1;o.forEach(function(t){var n;n=e.substring(i+1,t).trim();if(n!==""){a.push(n)}return i=t});h=e.substr(i+1).trim();if(h!==""){a.push(h)}return a};npmWishlist.sha256=function(e){var t,n,s,r,i,l,u,o,f,a,h,p,c,m,y,g,d,b,v,T,W,w,x,j,_,A,E,k,M,O,z,R,S,I,$,N,q,C,Z,J;if(e.length>Math.round(Math.pow(2,31)-1)){throw new Error}S=function(e){var t;return function(){var n,s;s=[];for(t=n=7;n>=0;t=--n){s.push(((e>>>t*4)%16).toString(16))}return s}().join("")};y=function(){var e,t,n,s;t=0;for(n=0,s=arguments.length;n<s;n++){e=arguments[n];t=(t+e)%4294967296}return t};u=function(e,t){return e>>>t|e<<32-t};o=function(e,t){return e>>>t};t=function(e,t,n){return e&t^~e&n};i=function(e,t,n){return e&t^e&n^t&n};f=function(e){return u(e,2)^u(e,13)^u(e,22)};a=function(e){return u(e,6)^u(e,11)^u(e,25)};O=function(e){return u(e,7)^u(e,18)^o(e,3)};z=function(e){return u(e,17)^u(e,19)^o(e,10)};s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];n=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];d=e.split("").map(function(e){return e.charCodeAt(0)});E=e.length*8;A=448-E-1;while(A<0){A+=512}M=E+1+A+64;d.push(128);for(j=I=0,J=Math.round((A-7)/8);0<=J?I<J:I>J;j=0<=J?++I:--I){d.push(0)}d.push(0);d.push(0);d.push(0);d.push(0);d.push(E>>>24);d.push((E>>>16)%256);d.push((E>>>8)%256);d.push(E%256);l=Math.round(M/512);r=new Array(l);for(j=$=0;0<=l?$<l:$>l;j=0<=l?++$:--$){r[j]=new Array(16);for(_=N=0;N<16;_=++N){k=j*64+_*4;r[j][_]=d[k]<<24|d[k+1]<<16|d[k+2]<<8|d[k+3]}}c=new Array(64);for(j=q=0;0<=l?q<l:q>l;j=0<=l?++q:--q){for(R=C=0;C<64;R=++C){c[R]=R<16?r[j][R]:y(z(c[R-2]),c[R-7],O(c[R-15]),c[R-16])}m=n[0];g=n[1];b=n[2];v=n[3];T=n[4];W=n[5];w=n[6];x=n[7];for(R=Z=0;Z<64;R=++Z){h=y(x,a(T),t(T,W,w),s[R],c[R]);p=y(f(m),i(m,g,b));x=w;w=W;W=T;T=y(v,h);v=b;b=g;g=m;m=y(h,p)}n[0]=y(m,n[0]);n[1]=y(g,n[1]);n[2]=y(b,n[2]);n[3]=y(v,n[3]);n[4]=y(T,n[4]);n[5]=y(W,n[5]);n[6]=y(w,n[6]);n[7]=y(x,n[7])}return n.map(function(e){return S(e)}).join("")};if(npmWishlist.environmentType==="browser"){window.npmWishlist=npmWishlist}else if(npmWishlist.environmentType==="node"){module.exports=npmWishlist}else{throw new Error}npmWishlist.packageInfo={name:"wishlist",version:"0.2.1",description:"Super natural testing framework.",keywords:["test","testing","async","unit","bdd","tdd","asynchronous","mocha","qunit","karma","jasmine","vows","qunitjs"],author:"Zhenzhen Zhan <zhanzhenzhen@hotmail.com>",homepage:"https://github.com/zhanzhenzhen/wishlist",licenses:[{type:"MIT",url:"https://github.com/zhanzhenzhen/wishlist/blob/master/LICENSE.txt"}],repository:{type:"git",url:"https://github.com/zhanzhenzhen/wishlist.git"},devDependencies:{"coffee-script":"1.7.1","uglify-js":"2.4.13"},main:"wishlist"}}).call(this);